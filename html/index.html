<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />

    <title>Repositor.io - Simple Linux Repository Management</title>

    <meta name="viewport" content="width=1024, initial-scale=0.5" />

    <link href="http://yandex.st/highlightjs/7.3/styles/magula.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="css/default.css?1" type="text/css" media="screen" charset="utf-8" />

    <meta name="description" content="repositor.io - Manage your package repositories the easy way." />
    <meta name="keywords" content="package, repository, rpm, yum, createrepo, patch management" />

    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

  </head>
  <body>
    <div id="menu">
      <ul>
        <li><a href="#home">Home</a></li>
        <li><a href="#getting_started">Getting Started</a></li>
        <li><a href="#mirror_a_repository">Mirror Repository</a></li>
        <li><a href="#create_custom_repository">Custom Repository</a></li>
        <li><a href="#configuration_management">Configuration Management</a></li>
      </ul>
      <div class="clear-fix"></div>
    </div>
    <div id="header">
      <img id="header_img" src="img/repositorio-text.png" />
    </div>
    <div id="content_pane">
      <div id="page_home" class="page start_page">
        <h1>What is repositor.io?</h1>
        <div class="content_text">
          <p>
            repositor.io is a tool to create and manage linux repositories.
            You can mirror online repositories so that you don't need to
            download the package every time you set up a new server.
            You can also secure your servers behind a firewall and disable
            outgoing http traffic.
          </p>
          <p>
            It is also possible to <a href="#errata">query repositorio for errata data</a> if an 
            errata database is available. Currently we manage databases for
            CentOS (5, 6, 7) and EPEL (5, 6, 7).
          </p>
          <p>
            Since version 0.3 it is also possible to use repositor.io as a 
            <a href="#docker">private docker</a> registry. So you can use repositor.io to create a
            private deployment pipeline with your private docker images.
          </p>
          <p>
            With repositor.io it is easy to create custom repositories for
            your own packages. With the integration of a
            <a href="#configuration_management">configuration management</a>
            tool you can create consistant installations of your server.
          </p>
        </div>
      </div>


      <div id="page_getting_started" class="page">
        <h1>Getting Started</h1>
        <div class="content_text">
          <p>
            Getting started with repositor.io is easy! Just open a terminal as root and run this command:
          </p>
          <pre><code class="bash">$ wget -O - http://get.repositor.io/ | bash</code></pre>
          <p>
            This will add the <a href="https://fedoraproject.org/wiki/EPEL">EPEL</a> and <a href="http://www.rexify.org/">(R)?ex</a> package repositories to your package manager (on CentOS and RedHat) and install the application.
          </p>
        </div>
      </div>

      <div id="page_mirror_a_repository" class="page">
        <h1>Using repositor.io to mirror a repository</h1>
        <div class="content_text">
          <p>
            First you have to create a configuration file. The installation already has created an example file for you
            in <b>/etc/rex/repositorio.conf</b>. Just open the file in an editor and add the repositories you want to mirror.
          </p>
          <p>
            Currently repositor.io supports <i>Yum</i> and <i>Apt</i> mirrors. If you want to contribute please visit our <a href="https://github.com/krimdomu/repositorio">Github</a> repository.
          </p>
          <p>
            Now you can run the mirror command to start the mirror process:
          </p>
          <pre><code class="bash">$ repositorio --mirror --repo=repository-name</code></pre>
          <p>
            repositorio will download the repository into the <i>head</i> branch. If you want to create a tag of a tested state you
can do this with the tag command:
          </p>
          <pre><code class="bash">$ repositorio --repo=repository-name --tag=production</code></pre>
        </div>
      </div>


      <div id="page_create_custom_repository" class="page">
        <h1>Using repositor.io to create a custom repository</h1>
        <div class="content_text">
          <p>
            First you have to edit your configuration file and add a new repository.
          </p>
          <pre><code>&lt;Repository custom-repo&gt;
  local = custom-repo/custom/6/x86_64/
  type  = Yum
&lt;/Repository&gt;</code></pre>
          <p>
            If you want to create an Apt repository instead the configuration looks a bit different.
          </p>
          <pre><code># line in sources.list:
# deb http://your-server.corp/custom-repo/debian wheezy custom
&lt;Repository custom-repo&gt;
  local     = custom-repo/debian
  type      = Apt
  arch      = amd64
  dist      = wheezy
  component = custom
&lt;/Repository&gt;</code></pre>
          <p>
            After adding your repository to the configuration file you can just initialize the new repository.
          </p>
          <p>
            For the <b>Yum</b> repository type you need to have <b>createrepo</b> installed on your system.
            For <b>Apt</b> you need <b>apt-ftparchive</b>.
          </p>
          <pre><code class="bash">$ repositorio --repo=custom-repo --init</code></pre>
          <p>
            Now you can add files to your new repository with the <i>add-file</i> command:
          </p>
          <pre><code class="bash">$ repositorio --repo=custom-repo --add-file=my-custom-package-1.0.rpm</code></pre>
          <h2>Signing repositories</h2>
            <p>If you want to sign your repositories, you have to create a gpg first. You can do this with the following command.</p>
                  <pre><code class="bash">$ gpg --gen-key</code></pre>
            <p>After you have create your key, you need to get the key id.</p>
                  <pre><code class="bash">$ gpg --list-secret-keys</code></pre>
            <p>You will see a line like this: <i>sec   2048R/DA95F273</i> and from this line you need <i>DA95F273</i></p>
            <p>Now you can edit the repositorio configuration file and add the following part to your custom repository.</p>
                  <pre><code>&lt;Repository custom-repo&gt;
  local = custom-repo/custom/6/x86_64/
  type  = Yum
  &lt;gpg&gt;
    key      = DA95F273
    password = passw0rd
  &lt;/gpg&gt;
&lt;/Repository&gt;</code></pre>
	  <p>For <b>Apt</b> repositories you have to extend the configuration with the same parameters.</p>
	  <p>If you don't want to add your password into the configuration file, you can just omit the password line. repositorio will ask you for the password during execution.</p>
        </div>
      </div>


      <div id="page_errata" class="page">
        <h1>Querying Errata</h1>
        <div class="content_text">
          <p>If you want to do proper patch management you always need to know which packages are on your servers and which updates are available for them. <i>repositor.io</i> has currently a database that can be queried to get information about package updates.</p>
          <p>This database can be used together with a configuration management tool like <a href="http://www.rexify.org/">(R)?ex</a> to manage package updates on your servers.</p>
          <h2>Configuration</h2>
          <p>To configure an errata database for a repository you have to define the errata type repositor.io should use. The following example configuration is a CentOS 6 mirror and will expose the errata database for CentOS 6.</p>
          <pre><code>&lt;Repository centos-6-x86-64&gt;
  url    = http://ftp.hosteurope.de/mirror/centos.org/6/os/x86_64/
  local  = centos-6-x86-64/CentOS/6/rex/x86_64/
  type   = Yum
  errata = CentOS-6
&lt;/Repository&gt;
</code></pre>
          <p>Currently we are maintaining errata databases for CentOS 5, 6, 7 and EPEL 5, 6, 7. If you want to provide errata databases for other distributions feel free to contact us on <a href="https://github.com/RexOps/repositorio">Github</a> or <a href="irc://irc.freenode.net/rex">irc.freenode.net</a> channel <b>#rex</b>.</p>
          <p>Valid errata types are:</p>
          <ul>
            <li>CentOS-5</li>
            <li>CentOS-6</li>
            <li>CentOS-7</li>
            <li>epel-5</li>
            <li>epel-6</li>
            <li>epel-7</li>
          </ul>
          <h2>Update Errata Database</h2>
          <p>To update your errata database you can use the <i>--update-errata</i> option. We are updating errata information every day.</p>
          <pre><code class="bash">$ repositorio --repo=centos-6-x86-64 --update-errata</code></pre>

          <h2>Query Errata Database</h2>
          <p>There are 2 types how you can query the errata database. You can use the command line tool <i>repositorio</i> or a webservice.</p>
          <p>To use the CLI run the following command.</p>
          <pre><code class="bash">$ repositorio --repo=centos-6-x86-64 --errata --package=openssl --arch=x86_64 --version=1.0.1e-16.el6_5.4</code></pre>
          <p>To use the webservice you first need to start an integrated webserver. This webserver can serve the contents of a repository and is used to query the errata database.</p>
          <pre><code class="bash">$ repositorio --repo=centos-6-x86-64 --server prefork</code></pre>
          <p>This will start a preforking webserver on port 3000. If you want to use another port you can get help for all the parameters with the following command.</p> 
          <pre><code class="bash">$ repositorio --repo=centos-6-x86-64 --server prefork -- --help</code></pre>

          <p>Now you can query the database with - for example - curl.</p>
          <pre><code class="bash">$ curl -XGET \
   http://yourrepo:3000/head/centos-6-x86-64/errata?package=openssl&amp;arch=x86_64&amp;version=1.0.1e-16.el6_5.4</code></pre>

          <h2>Have Problems?</h2>
          <p>If you have problems, questions or suggestions, feel free to open an issue on <a href="https://github.com/RexOps/repositorio">Github</a> and/or join our irc channel on <a href="irc://irc.freenode.net/rex">irc.freenode.net</a> channel <b>#rex</b>.</p>
        </div>
      </div>

      <div id="page_docker" class="page">
        <h1>Creating Docker Registry</h1>
        <div class="content_text">
          <p>To create a private docker registry you just need repositor.io and some place to store the images.</p>
          <h2>Configuration</h2>
          <p>First you need to configure the docker repository inside your <i>/etc/repositorio.conf</i> file.</p>
            <pre><code>&lt;Repository docker&gt;
    local = docker
    type  = Docker
&lt;/Repository&gt;</code></pre>

          <p>Now you can initialize the repository as usual. This will create a <i>docker</i> directory under your <i>RepositoryRoot</i>.</p>
          <pre><code class="bash">$ repositorio --repo=docker --init</code></pre>
          <h2>Serving Content</h2>
          <p>To get your Docker registry up and running you need to start a webserver to serve the content. You can't use a plain Apache or nginx server to serve the content because the docker client is not just downloading files like <i>yum</i> or <i>apt</i>. So repositor.io is comming with an integrated webserver.</p>
          <pre><code class="bash">$ repositorio --repo=docker --server prefork</code></pre>
          <p>This will start a preforking webserver on port 3000. If you want to use another port you can get help for all the parameters with the following command.</p> 
          <pre><code class="bash">$ repositorio --repo=docker --server prefork -- --help</code></pre>

          <h2>Creating User</h2>
          <p>Now you are ready to create users. To register a new user, you can use the <i>docker</i> client.</p>
          <pre><code class="bash">$ docker login -e some@mail.tld -p some-save-password -u some-user http://myserver:3000/v1/</code></pre>

          <h2>Push Images</h2>
          <p>After create a user you'll be able to push and pull images into repositor.io.</p>

          <p>First, download an image from the official docker registry.</p>
          <pre><code class="bash">$ docker pull ubuntu</code></pre>

          <p>Now you have to tag the image with a special name. You have to include the domain of your private registry in the tag name.</p>
          <pre><code class="bash">$ docker tag myserver:3000/ubuntu</code></pre>

          <p>After tagging your image, you can push it to your repositor.io server.</p>
          <pre><code class="bash">$ docker push myserver:3000/ubuntu</code></pre>

          <h2>Pull Images</h2>
          <p>Pulling an image is similar to pushing images.</p>
          <pre><code class="bash">$ docker pull myserver:3000/ubuntu</code></pre>

          <h2>Have Problems?</h2>
          <p>If you have problems, questions or suggestions, feel free to open an issue on <a href="https://github.com/RexOps/repositorio">Github</a> and/or join our irc channel on <a href="irc://irc.freenode.net/rex">irc.freenode.net</a> channel <b>#rex</b>.</p>
        </div>
      </div>

      <div id="page_configuration_management" class="page">
        <h1>Using Repositor.io with a configuration management tool</h1>
        <div class="content_text">
          <p>
            Here we will show you how to integration repositor.io with
            <a href="http://www.rexify.org/">Rex</a>. Rex is a simple configuration management tool
            based on SSH and Perl. So you don't need to install an agent on you servers. You just need an SSH account.
            To install Rex please see the <a href="http://www.rexify.org/get">installation instructions</a> on the website.
          </p>
          <p>
            First we will create a new Rex project.
          </p>
          <pre><code class="bash">$ rexify PackageManagement</code></pre>
          <p>
            Now you can open the Rexfile, add your servers, add a task to configure your new repository and a task to
update your packages.
          </p>
          <pre><code class="perl">use Rex -base;

user "root";

group myservers =&gt; "server1", "server2", "server3";

task "prepare", group =&gt; "myservers", make {
  repository
    add =&gt; "custom-repo",
    url =&gt; "http://repo-server.corp/production/custom-repo/custom/6/x86_64";
};

task "update_system", group =&gt; "myserver", make {
  update_package_db;
  update_system;
};</code></pre>
          <p>
            Save the file, and now you can add your custom repository to your systems and update them with one command:
          </p>
          <pre><code class="bash">$ rex prepare update_system</code></pre>
        </div>
      </div>

      <div style="margin-bottom: 35px"></div>



    </div>
    <a href="http://github.com/RexOps/repositorio"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub" /></a>
    <script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
        $('#header_img').effect('fade', null, 800);

        if(location.hash) {
          $('#page_home').hide();
          var div_to_show = '#page_' + location.hash.replace(/#/, '');
          $(div_to_show).effect('fade', null, 800, function() {
            $(div_to_show).addClass('page_shown');
          });
        }
        else {
          $('#page_home').addClass('page_shown');
        }

        hljs.tabReplace = '    ';
        hljs.initHighlighting();
      });

      $(window).on('hashchange', function(event) {
        var div_to_show = '#page_' + location.hash.replace(/#/, '');
        var old_shown = $('.page_shown');

        old_shown.effect('fade', null, 800, function() {
          $(div_to_show).effect('fade', null, 800);
          $(div_to_show).addClass('page_shown');
          old_shown.removeClass('page_shown');
        });
      });
    </script>

  <!-- Piwik -->
  <script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(["trackPageView"]);
    _paq.push(["enableLinkTracking"]);

    (function() {
      var u=(("https:" == document.location.protocol) ? "https" : "http") + "://stats.rexify.org/stats/";
      _paq.push(["setTrackerUrl", u+"piwik.php"]);
      _paq.push(["setSiteId", "2"]);
      var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
      g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Piwik Code -->
  </body>
</html>
